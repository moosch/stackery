"use strict";var getPositionInParent=function(e){for(var t=e.parentNode.parentNode.childNodes,n=[],a=0;a<t.length;a++)3!==t[a].nodeType&&n.push(t[a]);for(var s=-1,i=0;i<n.length;i++)if(n[i]===e.parentNode){s=i;break}return s},focusStack=function(e,t){var n=t.target.parentNode;if("true"===n.getAttribute("data-focussed"))return void unFocusStack(e,n);for(var a=e.container.getElementsByClassName("focussed"),s=0;s<a.length;s++)a[s].classList.remove("focussed");n.setAttribute("data-focussed","true"),n.classList.add("focussed"),n.style.zIndex=e.topZIndex+10},hoverReact=function(e){for(var t=0;t<e.elements.length;t++)e.elements[t].getElementsByTagName("img")[0].addEventListener("mouseover",function(t){spaceout(e,t)}),e.elements[t].getElementsByTagName("img")[0].addEventListener("mouseout",function(t){layout(e)}),e.elements[t].getElementsByTagName("img")[0].addEventListener("click",function(t){focusStack(e,t)})},layout=function(e){for(var t=0;t<e.elements.length;t++){var n=Math.round(e.elements.length/(t+1)*100);"true"!==e.elements[t].getAttribute("data-focussed")&&(e.elements[t].style.zIndex=n),e.topZIndex=n>e.topZIndex?n:e.topZIndex,e.elements[t].style.top=(t+1)*e.initTop+"px"}},reorder=function(e){var t=Array.prototype.slice.call(e.elements);t.sort(function(e,t){var n=e.getAttribute("data-stack-order"),a=t.getAttribute("data-stack-order");return null===n&&(n=getPositionInParent(e.getElementsByTagName("img")[0])),null===a&&(a=getPositionInParent(t.getElementsByTagName("img")[0])),n>a});for(var n,a=0,s=t.length;a<s;a++){n=t[a].parentNode;var i=n.removeChild(t[a]);n.appendChild(i)}return e.images=e.container.getElementsByTagName("img"),n.getElementsByClassName("stackery--stack")},resizeElement=function(e,t){var n=window.getComputedStyle(e.elements[t].getElementsByTagName("img")[0],null);if("undefined"!=n){var a=parseFloat(n.height)/parseFloat(n.width);e.elements[t].style.maxWidth=e.maxHeight/a+"px",e.elements[t].style.maxHeight=e.maxWidth+"px"}},setScene=function(e){e.maxHeight=window.innerHeight/2,e.maxWidth=window.innerWidth/2,e.topZIndex=0,e.initTop=e.maxHeight/4,e.container.style.marginTop=e.initTop+"px",e.elements=reorder(e),layout(e),hoverReact(e)},spaceout=function(e,t){var n=getPositionInParent(t.target);if("true"!==e.elements[n].getAttribute("data-focussed"))for(var a=e.maxHeight/4,s=0;s<e.elements.length;s++)s<n?e.elements[s].style.top=(s+1)*e.initTop-a+"px":s>n&&(e.elements[s].style.top=(s+1)*e.initTop+a+"px")},unFocusStack=function(e,t){t.setAttribute("data-focussed","false"),t.classList.remove("focussed"),layout(e)},Stackery=function(e){var t={container:e,elements:[],maxHeight:window.innerHeight/2,maxWidth:window.innerWidth/2,topZIndex:0,initTop:0,images:[]};t.elements=t.container.getElementsByClassName("stackery--stack"),t.initTop=t.maxHeight/4,t.container.style.marginTop=t.initTop+"px",setScene(t),t.container.classList.add("ready"),window.addEventListener("resize",function(){setScene(t)})};